{"componentChunkName":"component---src-pages-markdown-remark-frontmatter-slug-tsx","path":"/blog/redis/streams/","result":{"data":{"markdownRemark":{"html":"<p>Stream 데이터 타입은, 지금까지 본 데이터 타입과는 많이 다릅니다.\nlist와 sorted set이 섞인 형태라고 볼 수 있습니다.\n주로 서로 다른 서버 간 통신이 필요할 때 많이 사용합니다.</p>\n<h2>동작 원리</h2>\n<p>Message Producer -> Redis(stream) -> Message consumer\n와 같은 흐름을 가집니다.</p>\n<ol>\n<li>Producer가 message(Hash) 생성</li>\n<li>Redis의 Stream에 저장되고, ID(UNIX Timestamp)가 부여됨</li>\n<li>Consumer가 message 요청하면 전송. message를 전송해도 stream에 그대로 남아있음.</li>\n</ol>\n<h2>사용 예시</h2>\n<p>만약 <a href=\"mailto:A@gmail.com\">A@gmail.com</a>으로 메일을 보내달라는 요청이 들어왔다고 생각해봅시다.\n우리의 서버는 그 요청을 Third Party Email API로 전송하고 응답을 기다릴 것입니다.\nThird Party Email API에서 메일을 보내는 데에는 약간의 시간이 필요하므로, 그 기간동안 처음 들어온 요청은 대기하고 있을 것입니다.\n요청이 대기 상태로 있는건 그렇게 좋은 상황은 아닙니다.\nStream을 사용해 요청을 대기 상태에 두지 않고 처리할 수 있습니다.\n요청을 stream에 달아두고 응답을 반환하는 것이죠. 그럼 Email API가 비어있을 때 요청을 가져다 처리하면 됩니다.</p>\n<h2>명령어</h2>\n<h3>XADD</h3>\n<p>XADD [key] * [key] [value] [key] [value]</p>\n<ul>\n<li>\n<ul>\n<li>표시는 Redis에게 key를 생성해 달라는 의미입니다.</li>\n</ul>\n</li>\n<li>첫 key는 stream의 key를 의미합니다.</li>\n<li>뒤의 key value는 Hash에서와 같이 key value를 저장하는 것입니다.</li>\n</ul>\n<h3>XREAD</h3>\n<p>XREAD STREAMS [key] [range]</p>\n<ul>\n<li>range는 0-0와 같은 형태를 띕니다. 0-0는 stream의 모든 message를 읽겠다는 의미입니다. timestamp를 넣어 범위를 지정할 수 있습니다.</li>\n</ul>\n<p>XREAD COUNT 2 STREAMS [key] [range]</p>\n<ul>\n<li>XREAD와 STREAMS사이에 COUNT N을 넣으면 N개만 읽어올 수도 있습니다.</li>\n</ul>","frontmatter":{"date":"February 22, 2025","title":"Redis Streams"},"tableOfContents":"<ul>\n<li>\n<p><a href=\"#%EB%8F%99%EC%9E%91-%EC%9B%90%EB%A6%AC\">동작 원리</a></p>\n</li>\n<li>\n<p><a href=\"#%EC%82%AC%EC%9A%A9-%EC%98%88%EC%8B%9C\">사용 예시</a></p>\n</li>\n<li>\n<p><a href=\"#%EB%AA%85%EB%A0%B9%EC%96%B4\">명령어</a></p>\n<ul>\n<li><a href=\"#xadd\">XADD</a></li>\n<li><a href=\"#xread\">XREAD</a></li>\n</ul>\n</li>\n</ul>"}},"pageContext":{"id":"0c53c1e7-0c7c-5ee5-b89e-d329e3588b76","frontmatter__slug":"/blog/redis/streams","__params":{"frontmatter__slug":"blog"}}},"staticQueryHashes":["2018336255","2540505676","2678393935","2810064759","3398502926"],"slicesMap":{}}